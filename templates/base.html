<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <title>Vigil Build - Construction Management</title>
  <link rel="stylesheet" href="/static/tailwind.min.css"> <!-- Tailwind integration -->
  <link rel="stylesheet" href="/static/quill.snow.css"> <!-- Quill CSS -->
  <link rel="stylesheet" href="/static/css/buttons.css"> <!-- Button fixes -->
  <script src="/static/quill.min.js"></script> <!-- Quill JS -->
  <script src="/static/sortable.min.js"></script> <!-- Sortable JS -->
  <script src="/static/js/plotly.min.js"></script> <!-- Plotly JS -->
  <script>
    // Auto-add CSRF token to all forms on page load
    document.addEventListener('DOMContentLoaded', function() {
      const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
      document.querySelectorAll('form').forEach(function(form) {
        if (!form.querySelector('input[name="csrf_token"]')) {
          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = 'csrf_token';
          input.value = csrfToken;
          form.appendChild(input);
        }
      });
    });
  </script>
</head>
<body class="bg-gray-100 font-sans antialiased">
  {% include "navbar.html" %}

  <main class="container mx-auto p-4">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative" role="alert">
          {% for message in messages %}
            <p>{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>

  <footer class="bg-gray-800 text-white text-center py-4">
    Â© {{ current_year or 2025 }} Vigil Build. All rights reserved.
  </footer>

  <script src="/static/sw.js"></script> <!-- Service Worker -->
</body>
</html>